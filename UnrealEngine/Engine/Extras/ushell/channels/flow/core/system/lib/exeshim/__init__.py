# Copyright Epic Games, Inc. All Rights Reserved.

import os
import sys
import struct

#-------------------------------------------------------------------------------
class _K(object):
    py_section = 568
    py_subsystem = 276
    py_alignment = 16
    py_data = 2720
    py_payload = (
        b"\x4d\x5a\x90\x00\x03\x00\x00\x00\x04\x00\x00\x00\xff\xff\x00\x00\xb8\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x00\x00\x00"
        b"\x0e\x1f\xba\x0e\x00\xb4\x09\xcd\x21\xb8\x01\x4c\xcd\x21\x54\x68\x69\x73\x20\x70\x72\x6f\x67\x72\x61\x6d\x20\x63\x61\x6e\x6e\x6f\x74\x20\x62\x65\x20\x72\x75\x6e\x20\x69\x6e\x20\x44\x4f\x53\x20\x6d\x6f\x64\x65\x2e\x0d\x0d\x0a\x24\x00\x00\x00\x00\x00\x00\x00"
        b"\x39\x88\x04\xc5\x7d\xe9\x6a\x96\x7d\xe9\x6a\x96\x7d\xe9\x6a\x96\x36\x91\x6b\x97\x7e\xe9\x6a\x96\x7d\xe9\x6b\x96\x74\xe9\x6a\x96\xbc\x95\x6f\x97\x7c\xe9\x6a\x96\xbc\x95\x68\x97\x7c\xe9\x6a\x96\x52\x69\x63\x68\x7d\xe9\x6a\x96\x50\x45\x00\x00\x64\x86\x04\x00"
        b"\xe3\xc2\x11\x64\x00\x00\x00\x00\x00\x00\x00\x00\xf0\x00\x22\x00\x0b\x02\x0e\x22\xb0\x04\x00\x00\xa0\x03\x00\x00\x00\x00\x00\x00\x50\x05\x00\x00\x60\x02\x00\x00\x00\x00\x00\x40\x01\x00\x00\x00\x10\x00\x00\x00\x10\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00"
        b"\x06\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x60\x02\x00\x00\x00\x00\x00\x00\x03\x00\x60\x81\x00\x00\x10\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x20\x09\x00\x00\x28\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x50\x0a\x00\x00\x48\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x9c\x07\x00\x00\x1c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x07\x00\x00\x50\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        b"\x2e\x74\x65\x78\x74\x00\x00\x00\xaf\x04\x00\x00\x60\x02\x00\x00\xb0\x04\x00\x00\x60\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\x00\x00\x60\x2e\x72\x64\x61\x74\x61\x00\x00\x32\x03\x00\x00\x10\x07\x00\x00\x40\x03\x00\x00\x10\x07\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x40\x2e\x70\x64\x61\x74\x61\x00\x00\x48\x00\x00\x00\x50\x0a\x00\x00\x50\x00\x00\x00\x50\x0a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x40\x2e\x73\x68\x69\x6d\x00\x00\x00"
        b"\x04\x00\x00\x00\xa0\x0a\x00\x00\x10\x00\x00\x00\xa0\x0a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\xc0\x48\x8b\xc4\x48\x89\x58\x08\x48\x89\x68\x10\x48\x89\x70\x18\x48\x89\x78\x20\x41\x56\x0f\xb7\x11\x33\xff\x4c\x8b\xd9\x4c\x8b\xc9"
        b"\x4c\x8b\xc1\x44\x8b\xd7\x8d\x77\x20\x85\xd2\x0f\x84\xb3\x00\x00\x00\x0f\xb7\xc2\x8d\x6f\x22\x44\x8d\x77\x27\x66\x41\x89\x01\x49\x8d\x58\x02\x8b\xcf\x45\x85\xd2\x74\x38\x0f\xb7\x03\x41\x3b\xc2\x8b\xc7\x0f\x94\xc1\x83\xfa\x5c\x0f\x94\xc0\x85\xc8\x74\x09\x4c"
        b"\x8b\xc3\x66\x45\x89\x11\xeb\x65\x41\x3b\xd2\x44\x0f\x44\xd7\x41\x8b\xc2\xf7\xd8\x48\x1b\xc9\x48\xf7\xd1\x83\xe1\x02\x4c\x2b\xc9\xeb\x4b\x66\x44\x39\x33\x8b\xc7\x0f\x94\xc1\x66\x39\x2b\x0f\x94\xc0\x0b\xc8\x8b\xc7\x83\xfa\x5c\x0f\x44\xc1\x85\xc0\x74\x09\x4c"
        b"\x8b\xc3\x66\x41\x89\x29\xeb\x25\x41\x3b\xd6\x8b\xcf\x8b\xc7\x0f\x94\xc1\x3b\xd5\x0f\x94\xc0\x0b\xc8\xf7\xd9\x45\x1b\xd2\x44\x23\xd2\x74\x06\x49\x83\xe9\x02\xeb\x04\x3b\xd6\x76\x17\x49\x83\xc0\x02\x49\x83\xc1\x02\x41\x0f\xb7\x10\x0f\xb7\xc2\x85\xd2\x0f\x85"
        b"\x57\xff\xff\xff\x66\x41\x39\x30\x8b\xcf\x8b\xc7\x0f\x96\xc1\x66\x41\x39\x38\x0f\x95\xc0\x85\xc8\x74\x1a\x49\x83\xc0\x02\x8b\xd7\x8b\xcf\x66\x41\x39\x30\x0f\x96\xc2\x66\x41\x39\x38\x0f\x95\xc1\x85\xd1\x75\xe6\x48\x8b\x5c\x24\x10\x4d\x2b\xc3\x48\x8b\x6c\x24"
        b"\x18\x48\x8b\x74\x24\x20\x49\xd1\xf8\x66\x41\x89\x39\x41\x8b\xc0\x48\x8b\x7c\x24\x28\x41\x5e\xc3\x48\x8b\xc4\x48\x89\x58\x08\x48\x89\x68\x10\x48\x89\x70\x18\x48\x89\x78\x20\x44\x0f\xb7\x09\x33\xff\x48\x8b\xd9\x4c\x8b\xd1\x4c\x8b\xc1\x8b\xd7\x8d\x77\x20\x45"
        b"\x85\xc9\x0f\x84\x9a\x00\x00\x00\x41\x0f\xb7\xc1\x8d\x6f\x22\x66\x41\x89\x02\x4d\x8d\x58\x02\x8b\xcf\x85\xd2\x74\x37\x41\x0f\xb7\x03\x3b\xc2\x8b\xc7\x0f\x94\xc1\x41\x83\xf9\x5c\x0f\x94\xc0\x85\xc8\x74\x09\x4d\x8b\xc3\x66\x41\x89\x12\xeb\x4d\x44\x3b\xca\x0f"
        b"\x44\xd7\x8b\xc2\xf7\xd8\x48\x1b\xc9\x48\xf7\xd1\x83\xe1\x02\x4c\x2b\xd1\xeb\x35\x66\x41\x39\x2b\x8b\xc7\x0f\x94\xc1\x41\x83\xf9\x5c\x0f\x94\xc0\x85\xc8\x74\x09\x4d\x8b\xc3\x66\x41\x89\x2a\xeb\x18\x44\x3b\xcd\x8b\xd7\x41\x0f\x44\xd1\x85\xd2\x74\x06\x49\x83"
        b"\xea\x02\xeb\x05\x44\x3b\xce\x76\x19\x49\x83\xc0\x02\x49\x83\xc2\x02\x45\x0f\xb7\x08\x41\x0f\xb7\xc1\x45\x85\xc9\x0f\x85\x6d\xff\xff\xff\x66\x41\x39\x30\x8b\xcf\x8b\xc7\x0f\x96\xc1\x66\x41\x39\x38\x0f\x95\xc0\x85\xc8\x74\x1a\x49\x83\xc0\x02\x8b\xd7\x8b\xcf"
        b"\x66\x41\x39\x30\x0f\x96\xc2\x66\x41\x39\x38\x0f\x95\xc1\x85\xd1\x75\xe6\x48\x8b\x6c\x24\x10\x4c\x2b\xc3\x48\x8b\x5c\x24\x08\x48\x8b\x74\x24\x18\x49\xd1\xf8\x66\x41\x89\x3a\x41\x8b\xc0\x48\x8b\x7c\x24\x20\xc3\x48\x8b\xc4\x48\x89\x58\x08\x57\x48\x83\xec\x40"
        b"\x48\x83\x60\xe8\x00\x48\x8b\xd9\x83\x21\x00\x45\x33\xc9\x83\x60\xe0\x00\x48\x8d\x0d\x87\x02\x00\x00\x45\x33\xc0\xc7\x40\xd8\x03\x00\x00\x00\xba\x00\x00\x00\xc0\xff\x15\x32\x02\x00\x00\x48\x8b\xf8\x48\x85\xc0\x7e\x30\x48\x8b\xc8\xff\x15\x29\x02\x00\x00\x83"
        b"\xf8\x02\x75\x22\x48\x8b\xd3\x48\x8b\xcf\xff\x15\x38\x02\x00\x00\x85\xc0\x74\x12\x83\x0b\x04\x48\x8b\xcf\x8b\x13\xff\x15\x2e\x02\x00\x00\x48\x89\x7b\x08\x48\x8b\xc3\x48\x8b\x5c\x24\x50\x48\x83\xc4\x40\x5f\xc3\x48\x83\xec\x28\x48\x83\x79\x08\x00\x7e\x0c\x8b"
        b"\x11\x48\x8b\x49\x08\xff\x15\x05\x02\x00\x00\x48\x83\xc4\x28\xc3\x48\x8b\xc4\x48\x89\x58\x08\x48\x89\x68\x10\x48\x89\x70\x18\x48\x89\x78\x20\x41\x55\x41\x56\x41\x57\x48\x83\xec\x30\x48\x8d\x0d\x2e\x05\x00\x00\xff\x15\xc6\x01\x00\x00\x45\x33\xff\x48\x85\xc0"
        b"\x75\x09\x8d\x48\x3f\xe8\x7a\x01\x00\x00\xcc\x48\x8d\x15\xde\x01\x00\x00\x48\x8b\xc8\xff\x15\x9d\x01\x00\x00\x48\x8b\xe8\x48\x85\xc0\x75\x09\x8d\x48\x3e\xe8\x59\x01\x00\x00\xcc\x0f\xb7\x05\xed\x04\x00\x00\x4c\x8d\x2d\xe6\x04\x00\x00\x48\x8d\x0c\x45\xf8\xff"
        b"\xff\xff\x49\x03\xcd\xeb\x04\x48\x83\xe9\x02\x66\x83\x79\xfe\x6e\x75\xf5\xc7\x01\x2e\x00\x65\x00\x48\x8d\x15\xc3\x04\x00\x00\xc7\x41\x04\x78\x00\x65\x00\x66\x44\x89\x79\x08\x48\x8d\x0d\x86\x01\x00\x00\xff\x15\x20\x01\x00\x00\x0f\xb7\x05\xa1\x04\x00\x00\x48"
        b"\x8d\x1c\x45\x06\x00\x00\x00\x49\x03\xdd\x66\x44\x39\x7b\xfc\x75\x07\x66\x44\x39\x7b\xfe\x74\x06\x48\x83\xc3\x02\xeb\xec\xff\x15\xec\x00\x00\x00\x41\x8b\xd7\x41\x8b\xcf\x48\x8b\xf8\x66\x83\x38\x20\x0f\x96\xc2\x66\x44\x39\x38\x0f\x95\xc1\x85\xd1\x74\x1c\x48"
        b"\x83\xc7\x02\x41\x8b\xcf\x41\x8b\xc7\x66\x83\x3f\x20\x0f\x96\xc1\x66\x44\x39\x3f\x0f\x95\xc0\x85\xc8\x75\xe4\x48\x8b\xcf\x48\x89\x3b\xe8\x32\xfd\xff\xff\x48\x63\xc8\xbe\x01\x00\x00\x00\x0f\xb7\x05\x2b\x04\x00\x00\x8b\xd6\x4c\x8d\x34\x4f\x49\x8d\x4d\x02\x41"
        b"\xbd\x00\x01\x00\x00\x48\x8d\x0c\x41\x66\x44\x39\x39\x74\x26\x48\x89\x0c\xd3\x48\x83\xc1\x04\x66\x44\x39\x79\xfe\x74\x0d\x48\x8b\xc1\x48\x83\xc1\x02\x66\x44\x39\x38\x75\xf3\xff\xc6\x48\xff\xc2\x49\x3b\xd5\x7c\xd4\x48\x63\xfe\xeb\x1e\x66\x45\x39\x3e\x74\x1d"
        b"\x49\x8b\xce\x4c\x89\x34\xfb\xe8\x94\xfb\xff\xff\x4c\x63\xc0\xff\xc6\x48\xff\xc7\x4f\x8d\x34\x46\x49\x3b\xfd\x7c\xdd\x48\x8d\x4c\x24\x20\xe8\xcd\xfd\xff\xff\x48\x8b\xd3\x8b\xce\xff\xd5\x48\x8d\x4c\x24\x20\x8b\xd8\xe8\x3a\xfe\xff\xff\x8b\xcb\xe8\x03\x00\x00"
        b"\x00\xcc\xcc\xcc\x48\x83\xec\x28\xff\x15\x22\x00\x00\x00\xcc\x00\x98\x09\x00\x00\x00\x00\x00\x00\xaa\x09\x00\x00\x00\x00\x00\x00\xc4\x09\x00\x00\x00\x00\x00\x00\xd2\x09\x00\x00\x00\x00\x00\x00\xe0\x09\x00\x00\x00\x00\x00\x00\xee\x09\x00\x00\x00\x00\x00\x00"
        b"\x00\x0a\x00\x00\x00\x00\x00\x00\x10\x0a\x00\x00\x00\x00\x00\x00\x22\x0a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x43\x00\x4f\x00\x4e\x00\x4f\x00\x55\x00\x54\x00\x24\x00\x00\x00\x50\x79\x5f\x4d\x61\x69\x6e\x00\x50\x00\x59\x00\x54\x00\x48\x00"
        b"\x4f\x00\x4e\x00\x45\x00\x58\x00\x45\x00\x43\x00\x55\x00\x54\x00\x41\x00\x42\x00\x4c\x00\x45\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe3\xc2\x11\x64\x00\x00\x00\x00\x0d\x00\x00\x00\xec\x00\x00\x00\xd8\x07\x00\x00\xd8\x07\x00\x00\x18\x00\x00\x00\x02\x80\x02\x80"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\xd0\x07\x00\x00\x08\x00\x00\x00\x60\x02\x00\x00\xaf\x04\x00\x00\x00\x00\x00\x00\x60\x02\x00\x00\xaf\x04\x00\x00\x2e\x74\x65\x78\x74\x24\x6d\x6e\x00\x00\x00\x00\x10\x07\x00\x00\x50\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x35"
        b"\x00\x00\x00\x00\x60\x07\x00\x00\x58\x00\x00\x00\x2e\x72\x64\x61\x74\x61\x00\x00\xb8\x07\x00\x00\x20\x00\x00\x00\x2e\x72\x64\x61\x74\x61\x24\x76\x6f\x6c\x74\x6d\x64\x00\x00\x00\xd8\x07\x00\x00\xec\x00\x00\x00\x2e\x72\x64\x61\x74\x61\x24\x7a\x7a\x7a\x64\x62"
        b"\x67\x00\x00\x00\xc4\x08\x00\x00\x5c\x00\x00\x00\x2e\x78\x64\x61\x74\x61\x00\x00\x20\x09\x00\x00\x14\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x32\x00\x00\x00\x00\x34\x09\x00\x00\x14\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x33\x00\x00\x00\x00\x48\x09\x00\x00"
        b"\x50\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x34\x00\x00\x00\x00\x98\x09\x00\x00\xaa\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x36\x00\x00\x00\x00\x50\x0a\x00\x00\x48\x00\x00\x00\x2e\x70\x64\x61\x74\x61\x00\x00\xa0\x0a\x00\x00\x04\x00\x00\x00\x2e\x73\x68\x69"
        b"\x6d\x00\x00\x00\x01\x04\x01\x00\x04\x42\x00\x00\x01\x0c\x04\x00\x0c\x34\x0a\x00\x0c\x72\x08\x70\x01\x1d\x0c\x00\x1d\x74\x0d\x00\x1d\x64\x0c\x00\x1d\x54\x0b\x00\x1d\x34\x0a\x00\x1d\x52\x19\xf0\x17\xe0\x15\xd0\x01\x13\x08\x00\x13\x74\x04\x00\x0f\x64\x03\x00"
        b"\x0b\x54\x02\x00\x07\x34\x01\x00\x01\x15\x09\x00\x15\x74\x05\x00\x15\x64\x04\x00\x15\x54\x03\x00\x15\x34\x02\x00\x15\xe0\x00\x00\x48\x09\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x34\x0a\x00\x00\x10\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x98\x09\x00\x00\x00\x00\x00\x00\xaa\x09\x00\x00\x00\x00\x00\x00\xc4\x09\x00\x00\x00\x00\x00\x00\xd2\x09\x00\x00\x00\x00\x00\x00\xe0\x09\x00\x00\x00\x00\x00\x00\xee\x09\x00\x00\x00\x00\x00\x00\x00\x0a\x00\x00\x00\x00\x00\x00"
        b"\x10\x0a\x00\x00\x00\x00\x00\x00\x22\x0a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf1\x01\x47\x65\x74\x43\x6f\x6d\x6d\x61\x6e\x64\x4c\x69\x6e\x65\x57\x00\x46\x05\x53\x65\x74\x45\x6e\x76\x69\x72\x6f\x6e\x6d\x65\x6e\x74\x56\x61\x72\x69\x61\x62"
        b"\x6c\x65\x57\x00\xda\x00\x43\x72\x65\x61\x74\x65\x46\x69\x6c\x65\x57\x00\x6a\x02\x47\x65\x74\x46\x69\x6c\x65\x54\x79\x70\x65\x00\x78\x01\x45\x78\x69\x74\x50\x72\x6f\x63\x65\x73\x73\x00\xcd\x02\x47\x65\x74\x50\x72\x6f\x63\x41\x64\x64\x72\x65\x73\x73\x00\x00"
        b"\xe7\x03\x4c\x6f\x61\x64\x4c\x69\x62\x72\x61\x72\x79\x57\x00\x00\x16\x02\x47\x65\x74\x43\x6f\x6e\x73\x6f\x6c\x65\x4d\x6f\x64\x65\x00\x00\x2b\x05\x53\x65\x74\x43\x6f\x6e\x73\x6f\x6c\x65\x4d\x6f\x64\x65\x00\x00\x4b\x45\x52\x4e\x45\x4c\x33\x32\x2e\x64\x6c\x6c"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x60\x02\x00\x00\x98\x03\x00\x00\x08\x09\x00\x00\x98\x03\x00\x00\xb4\x04\x00\x00\xf4\x08\x00\x00\xb4\x04\x00\x00\x34\x05\x00\x00\xcc\x08\x00\x00\x34\x05\x00\x00\x50\x05\x00\x00\xc4\x08\x00\x00"
        b"\x50\x05\x00\x00\x02\x07\x00\x00\xd8\x08\x00\x00\x04\x07\x00\x00\x0f\x07\x00\x00\xc4\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
    )
    shim_section = 568
    shim_subsystem = 276
    shim_alignment = 16
    shim_data = 2256
    shim_payload = (
        b"\x4d\x5a\x90\x00\x03\x00\x00\x00\x04\x00\x00\x00\xff\xff\x00\x00\xb8\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x00\x00\x00"
        b"\x0e\x1f\xba\x0e\x00\xb4\x09\xcd\x21\xb8\x01\x4c\xcd\x21\x54\x68\x69\x73\x20\x70\x72\x6f\x67\x72\x61\x6d\x20\x63\x61\x6e\x6e\x6f\x74\x20\x62\x65\x20\x72\x75\x6e\x20\x69\x6e\x20\x44\x4f\x53\x20\x6d\x6f\x64\x65\x2e\x0d\x0d\x0a\x24\x00\x00\x00\x00\x00\x00\x00"
        b"\xf1\x02\x04\xcf\xb5\x63\x6a\x9c\xb5\x63\x6a\x9c\xb5\x63\x6a\x9c\xa1\x08\x6b\x9d\xb6\x63\x6a\x9c\xb5\x63\x6b\x9c\xbe\x63\x6a\x9c\x08\x16\x6f\x9d\xb4\x63\x6a\x9c\x08\x16\x68\x9d\xb4\x63\x6a\x9c\x52\x69\x63\x68\xb5\x63\x6a\x9c\x50\x45\x00\x00\x64\x86\x04\x00"
        b"\xba\x68\x12\x63\x00\x00\x00\x00\x00\x00\x00\x00\xf0\x00\x22\x00\x0b\x02\x0e\x1d\x00\x03\x00\x00\x80\x03\x00\x00\x00\x00\x00\x00\x1c\x03\x00\x00\x60\x02\x00\x00\x00\x00\x00\x40\x01\x00\x00\x00\x10\x00\x00\x00\x10\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00"
        b"\x06\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x60\x02\x00\x00\x00\x00\x00\x00\x03\x00\x60\x81\x00\x00\x10\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x2c\x07\x00\x00\x28\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xa0\x08\x00\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xd4\x05\x00\x00\x1c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x60\x05\x00\x00\x60\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        b"\x2e\x74\x65\x78\x74\x00\x00\x00\xf4\x02\x00\x00\x60\x02\x00\x00\x00\x03\x00\x00\x60\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\x00\x00\x60\x2e\x72\x64\x61\x74\x61\x00\x00\x32\x03\x00\x00\x60\x05\x00\x00\x40\x03\x00\x00\x60\x05\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x40\x2e\x70\x64\x61\x74\x61\x00\x00\x30\x00\x00\x00\xa0\x08\x00\x00\x30\x00\x00\x00\xa0\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x40\x2e\x73\x68\x69\x6d\x00\x00\x00"
        b"\x06\x00\x00\x00\xd0\x08\x00\x00\x10\x00\x00\x00\xd0\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\xc0\x33\xc0\x83\xf9\x02\x0f\x92\xc0\xc3\xcc\xcc\xcc\x48\x8b\xc4\x48\x89\x58\x08\x57\x48\x83\xec\x40\x48\x83\x60\xe8\x00\x48\x8b\xd9"
        b"\x83\x21\x00\x45\x33\xc9\x83\x60\xe0\x00\x48\x8d\x0d\x2f\x03\x00\x00\x45\x33\xc0\xc7\x40\xd8\x03\x00\x00\x00\xba\x00\x00\x00\xc0\xff\x15\xc2\x02\x00\x00\x48\x8b\xf8\x48\x85\xc0\x7e\x30\x48\x8b\xc8\xff\x15\xb9\x02\x00\x00\x83\xf8\x02\x75\x22\x48\x8b\xd3\x48"
        b"\x8b\xcf\xff\x15\xd8\x02\x00\x00\x85\xc0\x74\x12\x83\x0b\x04\x48\x8b\xcf\x8b\x13\xff\x15\xce\x02\x00\x00\x48\x89\x7b\x08\x48\x8b\xc3\x48\x8b\x5c\x24\x50\x48\x83\xc4\x40\x5f\xc3\x48\x83\xec\x28\x48\x83\x79\x08\x00\x7e\x0c\x8b\x11\x48\x8b\x49\x08\xff\x15\xa5"
        b"\x02\x00\x00\x48\x83\xc4\x28\xc3\x48\x8d\x05\x51\xff\xff\xff\xc3\x48\x83\xec\x28\xff\x15\x66\x02\x00\x00\xcc\xcc\x4c\x8b\xdc\x49\x89\x5b\x08\x49\x89\x6b\x18\x56\x57\x41\x54\x41\x56\x41\x57\x48\x81\xec\xf0\x00\x00\x00\x48\x8d\x0d\x93\x02\x00\x00\x48\x81\xe1"
        b"\x00\x00\xff\xff\x48\x63\x41\x3c\x0f\xb7\x6c\x08\x5c\x66\x83\xfd\x03\x75\x17\x49\x8d\x4b\x10\xe8\xac\xff\xff\xff\x48\x8b\xc8\xba\x01\x00\x00\x00\xff\x15\x46\x02\x00\x00\x33\xdb\x48\x8d\x35\x61\x05\x00\x00\x44\x8a\xc3\x48\x8b\xc6\x44\x8d\x63\x02\x0f\xb7\x08"
        b"\x66\x85\xc9\x74\x11\x66\x83\xf9\x2f\x41\x0f\x94\xc0\x49\x03\xc4\x66\x83\xf9\x2f\x75\xe7\x66\x83\x3d\x38\x05\x00\x00\x3a\x75\x07\xba\x01\x00\x00\x00\xeb\x09\x45\x84\xc0\x8b\xd3\x41\x0f\x45\xd4\x0f\xb7\x0d\x19\x05\x00\x00\x4c\x8d\x05\x12\x05\x00\x00\x0f\xb7"
        b"\x3d\x0d\x05\x00\x00\x4c\x8b\xfe\x49\x03\xfc\x48\x03\xf9\x4c\x8d\x71\x02\x4f\x8d\x34\x70\x49\x8d\x3c\x78\x41\x3b\xd4\x75\x36\x41\xb8\x00\x40\x00\x00\x48\x8b\xd7\x33\xc9\x4c\x8b\xff\xff\x15\xa5\x01\x00\x00\x8b\xc0\x48\x8d\x3c\x47\x49\x2b\xfc\x66\x83\x7f\xfe"
        b"\x5c\x75\xf6\x48\x2b\xf7\x0f\xb7\x04\x3e\x66\x89\x07\x49\x03\xfc\x66\x85\xc0\x75\xf1\x48\x8b\xf7\xff\x15\x42\x01\x00\x00\x41\xb9\x22\x00\x00\x00\x48\x8b\xd0\x66\x44\x39\x08\x75\x30\x45\x8b\xc4\x41\x0f\xb7\xc1\x49\x03\xd4\x66\x89\x06\x49\x03\xf4\x8b\xcb\x66"
        b"\x44\x39\x4a\xfe\x0f\x94\xc1\x44\x2b\xc1\x74\x33\x0f\xb7\x02\x66\x85\xc0\x75\xe0\x66\x44\x89\x0e\x49\x03\xf4\xeb\x22\x48\x8b\xcf\x48\x2b\xc8\x0f\xb7\x02\x48\x8d\x34\x11\x66\x89\x06\x4c\x8b\xc2\x0f\xb7\x02\x49\x03\xd4\x66\x83\xf8\x20\x77\xe7\x49\x8b\xd0\x49"
        b"\x2b\xf6\x41\x0f\xb7\x06\x4a\x8d\x0c\x36\x66\x89\x01\x41\x0f\xb7\x06\x4d\x03\xf4\x66\x85\xc0\x75\xe9\x0f\xb7\x02\x49\x03\xd4\x66\x89\x01\x49\x03\xcc\x0f\xb7\x02\x66\x85\xc0\x75\xef\x48\x8d\x4c\x24\x50\xe8\xb5\xfd\xff\xff\x48\x8d\x44\x24\x60\xc7\x84\x24\x80"
        b"\x00\x00\x00\x68\x00\x00\x00\x48\x89\x44\x24\x48\x45\x33\xc9\x48\x8d\x84\x24\x80\x00\x00\x00\x45\x33\xc0\x48\x89\x44\x24\x40\x48\x8b\xd7\x48\x89\x5c\x24\x38\x49\x8b\xcf\x48\x89\x5c\x24\x30\xc7\x44\x24\x28\x00\x00\x01\x00\x89\x5c\x24\x20\xff\x15\x8f\x00\x00"
        b"\x00\x83\xf8\x01\x75\x37\x66\x83\xfd\x03\x75\x36\x48\x8b\x4c\x24\x60\x83\xca\xff\xff\x15\x5e\x00\x00\x00\x48\x8b\x4c\x24\x60\x48\x8d\x94\x24\x28\x01\x00\x00\x89\x9c\x24\x28\x01\x00\x00\xff\x15\x54\x00\x00\x00\x8b\x9c\x24\x28\x01\x00\x00\xeb\x05\xbb\x31\x23"
        b"\x00\x00\x48\x8d\x4c\x24\x50\xe8\xa0\xfd\xff\xff\x8b\xcb\xe8\xbd\xfd\xff\xff\xcc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x07\x00\x00\x00\x00\x00\x00\xca\x07\x00\x00\x00\x00\x00\x00\xd8\x07\x00\x00\x00\x00\x00\x00\xe6\x07\x00\x00\x00\x00\x00\x00"
        b"\xfc\x07\x00\x00\x00\x00\x00\x00\x0a\x08\x00\x00\x00\x00\x00\x00\x20\x08\x00\x00\x00\x00\x00\x00\x32\x08\x00\x00\x00\x00\x00\x00\x48\x08\x00\x00\x00\x00\x00\x00\x5a\x08\x00\x00\x00\x00\x00\x00\x6c\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        b"\x43\x00\x4f\x00\x4e\x00\x4f\x00\x55\x00\x54\x00\x24\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xba\x68\x12\x63\x00\x00\x00\x00\x0d\x00\x00\x00\xec\x00\x00\x00\x10\x06\x00\x00\x10\x06\x00\x00\x18\x00\x00\x00\x02\x80\x02\x80\x00\x00\x00\x00\x00\x00\x00\x00"
        b"\x08\x06\x00\x00\x08\x00\x00\x00\x60\x02\x00\x00\xf4\x02\x00\x00\x00\x00\x00\x00\x60\x02\x00\x00\xf4\x02\x00\x00\x2e\x74\x65\x78\x74\x24\x6d\x6e\x00\x00\x00\x00\x60\x05\x00\x00\x60\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x35\x00\x00\x00\x00\xc0\x05\x00\x00"
        b"\x30\x00\x00\x00\x2e\x72\x64\x61\x74\x61\x00\x00\xf0\x05\x00\x00\x20\x00\x00\x00\x2e\x72\x64\x61\x74\x61\x24\x76\x6f\x6c\x74\x6d\x64\x00\x00\x00\x10\x06\x00\x00\xec\x00\x00\x00\x2e\x72\x64\x61\x74\x61\x24\x7a\x7a\x7a\x64\x62\x67\x00\x00\x00\xfc\x06\x00\x00"
        b"\x30\x00\x00\x00\x2e\x78\x64\x61\x74\x61\x00\x00\x2c\x07\x00\x00\x14\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x32\x00\x00\x00\x00\x40\x07\x00\x00\x18\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x33\x00\x00\x00\x00\x58\x07\x00\x00\x60\x00\x00\x00\x2e\x69\x64\x61"
        b"\x74\x61\x24\x34\x00\x00\x00\x00\xb8\x07\x00\x00\xda\x00\x00\x00\x2e\x69\x64\x61\x74\x61\x24\x36\x00\x00\x00\x00\xa0\x08\x00\x00\x30\x00\x00\x00\x2e\x70\x64\x61\x74\x61\x00\x00\xd0\x08\x00\x00\x06\x00\x00\x00\x2e\x73\x68\x69\x6d\x00\x00\x00\x01\x04\x01\x00"
        b"\x04\x42\x00\x00\x01\x0c\x04\x00\x0c\x34\x0a\x00\x0c\x72\x08\x70\x01\x1a\x0b\x00\x1a\x54\x26\x00\x1a\x34\x24\x00\x1a\x01\x1e\x00\x13\xf0\x11\xe0\x0f\xc0\x0d\x70\x0c\x60\x00\x00\x58\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x08\x00\x00\x60\x05\x00\x00"
        b"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xb8\x07\x00\x00\x00\x00\x00\x00\xca\x07\x00\x00\x00\x00\x00\x00\xd8\x07\x00\x00\x00\x00\x00\x00\xe6\x07\x00\x00\x00\x00\x00\x00\xfc\x07\x00\x00\x00\x00\x00\x00"
        b"\x0a\x08\x00\x00\x00\x00\x00\x00\x20\x08\x00\x00\x00\x00\x00\x00\x32\x08\x00\x00\x00\x00\x00\x00\x48\x08\x00\x00\x00\x00\x00\x00\x5a\x08\x00\x00\x00\x00\x00\x00\x6c\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xe0\x01\x47\x65\x74\x43\x6f\x6d"
        b"\x6d\x61\x6e\x64\x4c\x69\x6e\x65\x57\x00\xce\x00\x43\x72\x65\x61\x74\x65\x46\x69\x6c\x65\x57\x00\x58\x02\x47\x65\x74\x46\x69\x6c\x65\x54\x79\x70\x65\x00\xea\x05\x57\x61\x69\x74\x46\x6f\x72\x53\x69\x6e\x67\x6c\x65\x4f\x62\x6a\x65\x63\x74\x00\x67\x01\x45\x78"
        b"\x69\x74\x50\x72\x6f\x63\x65\x73\x73\x00\x46\x02\x47\x65\x74\x45\x78\x69\x74\x43\x6f\x64\x65\x50\x72\x6f\x63\x65\x73\x73\x00\x00\xe8\x00\x43\x72\x65\x61\x74\x65\x50\x72\x6f\x63\x65\x73\x73\x57\x00\x00\x7d\x02\x47\x65\x74\x4d\x6f\x64\x75\x6c\x65\x46\x69\x6c"
        b"\x65\x4e\x61\x6d\x65\x57\x00\x00\x05\x02\x47\x65\x74\x43\x6f\x6e\x73\x6f\x6c\x65\x4d\x6f\x64\x65\x00\x00\x09\x05\x53\x65\x74\x43\x6f\x6e\x73\x6f\x6c\x65\x4d\x6f\x64\x65\x00\x00\xf9\x04\x53\x65\x74\x43\x6f\x6e\x73\x6f\x6c\x65\x43\x74\x72\x6c\x48\x61\x6e\x64"
        b"\x6c\x65\x72\x00\x4b\x45\x52\x4e\x45\x4c\x33\x32\x2e\x64\x6c\x6c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x6c\x02\x00\x00\xec\x02\x00\x00\x04\x07\x00\x00\xec\x02\x00\x00\x08\x03\x00\x00\xfc\x06\x00\x00\x10\x03\x00\x00\x1b\x03\x00\x00"
        b"\xfc\x06\x00\x00\x1c\x03\x00\x00\x54\x05\x00\x00\x10\x07\x00\x00"
    )

#-------------------------------------------------------------------------------
def create_py(shim_path, *args):
    dll_path = os.path.dirname(sys.executable)
    dll_path += rf"\python{sys.version_info.major}{sys.version_info.minor}.dll"

    out = open(shim_path, "wb")
    out.write(_K.py_payload)

    out.seek(_K.py_data)

    out.write(struct.pack("H", len(dll_path) + 1)) # +1 for null terminator
    out.write(dll_path.encode("utf16")[2:])        # "[2:]" strips the BOM
    out.write(struct.pack("H", 0))

    for arg in args:
        out.write(arg.encode("utf16")[2:])
        out.write(struct.pack("H", 0))
    out.write(struct.pack("H", 0))

    align_mask = _K.py_alignment - 1
    padding = out.tell() - _K.py_data
    padding = ((padding + align_mask) & ~align_mask) - padding
    for i in range(padding):
        out.write(b"\0")

    section_size = out.tell() - _K.py_data
    out.seek(_K.py_section + 16)
    out.write(struct.pack("I", section_size))

    out.close()

#-------------------------------------------------------------------------------
def create(shim_path, target_path, args=""):
    # Condition input
    target_path = target_path.replace("\\", "/")
    if args:
        args = " " + args

    out = open(shim_path, "wb")

    # Get the target's subsystem.
    full_target_path = os.path.join(os.path.dirname(out.name), target_path)
    with open(full_target_path, "rb") as exe_file:
        # DOS header
        dos_header = exe_file.read(64)
        dos_header = struct.unpack("H" + ("H" * 29) + "I", dos_header)
        pe_offset = dos_header[-1]
        assert dos_header[0] == 0x5a4d

        # NT header
        exe_file.seek(pe_offset)
        pe_magic, = struct.unpack("I", exe_file.read(4))
        assert pe_magic == 0x4550 # 'PE'

        # File header
        file_header = struct.unpack("HHIIIHH", exe_file.read(20))
        optional_header_size = file_header[-2] - (8 * 16)

        # Optional header
        optional_header = exe_file.read(optional_header_size)
        if file_header[0] == 0x8664: opt_unpack = "HBBIIIIIQIIHHHHHHIIIIHHQQQQII"
        else: opt_unpack = "HBBIIIIIIIIIHHHHHHIIIIHHIIIIII"
        optional_header = struct.unpack(opt_unpack, optional_header)
        subsystem = optional_header[-8]
        assert subsystem == 2 or subsystem == 3

    out.write(_K.shim_payload)

    out.seek(_K.shim_subsystem)
    out.write(struct.pack("H", subsystem))

    out.seek(_K.shim_data)

    out.write(struct.pack("H", len(target_path) + 1)) # +1 for null terminator
    out.write(struct.pack("H", len(args) + 1))        # +1 for null terminator

    out.write(target_path.encode("utf16")[2:])        # "[2:]" strips the BOM
    out.write(struct.pack("H", 0))

    out.write(args.encode("utf16")[2:])               # "[2:]" strips the BOM
    out.write(struct.pack("H", 0))

    align_mask = _K.shim_alignment - 1
    padding = out.tell() - _K.shim_data
    padding = ((padding + align_mask) & ~align_mask) - padding
    for i in range(padding):
        out.write(b"\0")

    section_size = out.tell() - _K.shim_data
    out.seek(_K.shim_section + 16)
    out.write(struct.pack("I", section_size))

    out.close()
